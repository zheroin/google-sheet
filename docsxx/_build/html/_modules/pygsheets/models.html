

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pygsheets.models &mdash; pygsheets 1.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="pygsheets 1.1 documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> pygsheets
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../authorizing.html">Authorizing pygsheets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference.html">pygsheets API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference.html#indices-and-tables">Indices and tables</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">pygsheets</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>pygsheets.models</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pygsheets.models</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">pygsheets.models</span>
<span class="sd">~~~~~~~~~~~~~~~~</span>

<span class="sd">This module contains common spreadsheets&#39; models</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">.exceptions</span> <span class="kn">import</span> <span class="n">IncorrectCellLabel</span><span class="p">,</span> <span class="n">WorksheetNotFound</span><span class="p">,</span> <span class="n">CellNotFound</span><span class="p">,</span> <span class="n">InvalidArgumentValue</span><span class="p">,</span> <span class="n">InvalidUser</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">finditem</span><span class="p">,</span> <span class="n">numericise_all</span>
<span class="kn">from</span> <span class="nn">custom_types</span> <span class="kn">import</span> <span class="o">*</span>


<div class="viewcode-block" id="Spreadsheet"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Spreadsheet">[docs]</a><span class="k">class</span> <span class="nc">Spreadsheet</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot; A class for a spreadsheet object.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">,</span> <span class="n">jsonsheet</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; spreadsheet init.</span>

<span class="sd">        :param client: the client object which links to this ssheet</span>
<span class="sd">        :param jsonsheet: the json sheet which has properties of this ssheet</span>
<span class="sd">        :param id: id of the spreadsheet</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sheet_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_jsonsheet</span> <span class="o">=</span> <span class="n">jsonsheet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_id</span> <span class="o">=</span> <span class="nb">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_properties</span><span class="p">(</span><span class="n">jsonsheet</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_permissions</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> Sheets:</span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span>
                                      <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sheet_list</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; id of the spreadsheet &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_id</span>

    <span class="c1"># @TODO - link changes with colud</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; title of the spreadsheet &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_title</span>

    <span class="c1"># @TODO - link changes with colud</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">defaultformat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; deafault cell format&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defaultFormat</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sheet1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shortcut property for getting the first worksheet.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">worksheet</span><span class="p">()</span>

<div class="viewcode-block" id="Spreadsheet.get_id_fields"><a class="viewcode-back" href="../../pygsheets.html#pygsheets.models.Spreadsheet.get_id_fields">[docs]</a>    <span class="k">def</span> <span class="nf">get_id_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;spreadsheet_id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">}</span></div>

    <span class="k">def</span> <span class="nf">_update_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jsonsheet</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Update all sheet properies.</span>

<span class="sd">        :param jsonsheet: json var to update values form \</span>
<span class="sd">                if not specified, will fetch it and update</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">jsonsheet</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_jsonsheet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">open_by_key</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s1">&#39;json&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">jsonsheet</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidArgumentValue</span>
        <span class="c1"># print self._jsonsheet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_jsonsheet</span><span class="p">[</span><span class="s1">&#39;spreadsheetId&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_sheets</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_jsonsheet</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_jsonsheet</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultFormat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_jsonsheet</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;defaultFormat&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">spreadsheetId</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_id</span>

    <span class="k">def</span> <span class="nf">_fetch_sheets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jsonsheet</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;update sheets list&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">jsonsheet</span><span class="p">:</span>
            <span class="n">jsonsheet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">open_by_key</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">returnas</span><span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sheet</span> <span class="ow">in</span> <span class="n">jsonsheet</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sheets&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sheet_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Worksheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheet</span><span class="p">))</span>

    <span class="c1"># @TODO</span>
<div class="viewcode-block" id="Spreadsheet.link"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Spreadsheet.link">[docs]</a>    <span class="k">def</span> <span class="nf">link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">syncToColoud</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Link the spread sheet with colud, so all local changes \</span>
<span class="sd">            will be updated instantly, so does all data fetches</span>

<span class="sd">            :param  syncToColoud: update the cloud with local changes if set to true</span>
<span class="sd">                          update the local copy with cloud if set to false</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

    <span class="c1"># @TODO</span>
<div class="viewcode-block" id="Spreadsheet.unlink"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Spreadsheet.unlink">[docs]</a>    <span class="k">def</span> <span class="nf">unlink</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Unlink the spread sheet with colud, so all local changes</span>
<span class="sd">            will be made on local copy fetched</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Spreadsheet.share"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Spreadsheet.share">[docs]</a>    <span class="k">def</span> <span class="nf">share</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="s1">&#39;reader&#39;</span><span class="p">,</span> <span class="n">expirationTime</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">is_group</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        create/update permission for user/group/domain</span>

<span class="sd">        :param addr: this is the email for user/group and domain adress for domains</span>
<span class="sd">        :param role: permission to be applied (&#39;owner&#39;,&#39;writer&#39;,&#39;commenter&#39;,&#39;reader&#39;)</span>
<span class="sd">        :param expirationTime: (Not Implimented) time until this permission should last (datetime)</span>
<span class="sd">        :param is_group: boolean , Is this a use/group used only when email provided</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">add_permission</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">role</span><span class="p">,</span> <span class="n">is_group</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spreadsheet.list_permissions"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Spreadsheet.list_permissions">[docs]</a>    <span class="k">def</span> <span class="nf">list_permissions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        list all the permissions of the spreadsheet</span>
<span class="sd">        :returns: list of permissions as json object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">permissions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">list_permissions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_permissions</span> <span class="o">=</span> <span class="n">permissions</span><span class="p">[</span><span class="s1">&#39;permissions&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_permissions</span></div>

<div class="viewcode-block" id="Spreadsheet.remove_permissions"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Spreadsheet.remove_permissions">[docs]</a>    <span class="k">def</span> <span class="nf">remove_permissions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes all permissions of the user provided</span>

<span class="sd">        :param addr: email/domain of the user</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">remove_permissions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_permissions</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">InvalidUser</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">remove_permissions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="Spreadsheet.add_worksheet"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Spreadsheet.add_worksheet">[docs]</a>    <span class="k">def</span> <span class="nf">add_worksheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a new worksheet to a spreadsheet.</span>

<span class="sd">        :param title: A title of a new worksheet.</span>
<span class="sd">        :param rows: Number of rows.</span>
<span class="sd">        :param cols: Number of columns.</span>

<span class="sd">        :returns: a newly created :class:`worksheets &lt;Worksheet&gt;`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">jsheet</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">jsheet</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>
        <span class="n">wks</span> <span class="o">=</span> <span class="n">Worksheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jsheet</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sheet_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wks</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wks</span></div>

<div class="viewcode-block" id="Spreadsheet.del_worksheet"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Spreadsheet.del_worksheet">[docs]</a>    <span class="k">def</span> <span class="nf">del_worksheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">worksheet</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes a worksheet from a spreadsheet.</span>

<span class="sd">        :param worksheet: The worksheet to be deleted.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">worksheet</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">worksheets</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">WorksheetNotFound</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">del_worksheet</span><span class="p">(</span><span class="n">worksheet</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sheet_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">worksheet</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spreadsheet.worksheets"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Spreadsheet.worksheets">[docs]</a>    <span class="k">def</span> <span class="nf">worksheets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheet_property</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get all worksheets filtered by a property.</span>

<span class="sd">        :param sheet_property: proptery to filter - &#39;title&#39;, &#39;index&#39;, &#39;id&#39;</span>
<span class="sd">        :param value: value of property to match</span>

<span class="sd">        :returns: list of all :class:`worksheets &lt;Worksheet&gt;`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sheet_property</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sheet_list</span>

        <span class="k">if</span> <span class="n">sheet_property</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">InvalidArgumentValue</span>

        <span class="n">sheets</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sheet_list</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sheet_property</span><span class="p">)</span> <span class="o">==</span> <span class="n">value</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">sheets</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_sheets</span><span class="p">()</span>
            <span class="n">sheets</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sheet_list</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sheet_property</span><span class="p">)</span> <span class="o">==</span> <span class="n">value</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">sheets</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">WorksheetNotFound</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">sheets</span></div>

<div class="viewcode-block" id="Spreadsheet.worksheet"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Spreadsheet.worksheet">[docs]</a>    <span class="k">def</span> <span class="nf">worksheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">property</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a worksheet with specified `title`.</span>

<span class="sd">        :param property: A property of a worksheet. If there&#39;re multiple worksheets \</span>
<span class="sd">                        with the same title, first one will be returned.</span>
<span class="sd">        :param value: value of given property</span>

<span class="sd">        :type property: &#39;title&#39;,&#39;index&#39;,&#39;id&#39;</span>

<span class="sd">        :returns: instance of :class:`Worksheet`</span>

<span class="sd">        Example. Getting worksheet named &#39;Annual bonuses&#39;</span>

<span class="sd">        &gt;&gt;&gt; sht = client.open(&#39;Sample one&#39;)</span>
<span class="sd">        &gt;&gt;&gt; worksheet = sht.worksheet(&#39;title&#39;,&#39;Annual bonuses&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">worksheets</span><span class="p">(</span><span class="nb">property</span><span class="p">,</span> <span class="n">value</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Spreadsheet.worksheet_by_title"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Spreadsheet.worksheet_by_title">[docs]</a>    <span class="k">def</span> <span class="nf">worksheet_by_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns worksheet by title</span>

<span class="sd">        :param title: title of the sheet</span>

<span class="sd">        :returns: Spresheet instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">worksheet</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">sheet</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">worksheets</span><span class="p">():</span>
            <span class="k">yield</span><span class="p">(</span><span class="n">sheet</span><span class="p">)</span></div>


<div class="viewcode-block" id="Worksheet"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet">[docs]</a><span class="k">class</span> <span class="nc">Worksheet</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A class for worksheet object.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spreadsheet</span><span class="p">,</span> <span class="n">jsonSheet</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spreadsheet</span> <span class="o">=</span> <span class="n">spreadsheet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">spreadsheet</span><span class="o">.</span><span class="n">client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_linked</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jsonSheet</span> <span class="o">=</span> <span class="n">jsonSheet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_grid</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c1"># for storing sheet data while unlinked</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> index:</span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span>
                                  <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">),</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Id of a worksheet.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">jsonSheet</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;sheetId&#39;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Index of worksheet&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">jsonSheet</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Title of a worksheet.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">jsonSheet</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>

    <span class="nd">@title.setter</span>
    <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jsonSheet</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">title</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_linked</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">update_sheet_properties</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jsonSheet</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">],</span> <span class="s1">&#39;title&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Number of rows&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jsonSheet</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;gridProperties&#39;</span><span class="p">][</span><span class="s1">&#39;rowCount&#39;</span><span class="p">])</span>

    <span class="nd">@rows.setter</span>
    <span class="k">def</span> <span class="nf">rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_count</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jsonSheet</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;gridProperties&#39;</span><span class="p">][</span><span class="s1">&#39;rowCount&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row_count</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_linked</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">update_sheet_properties</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jsonSheet</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">],</span> <span class="s1">&#39;gridProperties/rowCount&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Number of columns&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jsonSheet</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;gridProperties&#39;</span><span class="p">][</span><span class="s1">&#39;columnCount&#39;</span><span class="p">])</span>

    <span class="nd">@cols.setter</span>
    <span class="k">def</span> <span class="nf">cols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_count</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jsonSheet</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;gridProperties&#39;</span><span class="p">][</span><span class="s1">&#39;columnCount&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">col_count</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_linked</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">update_sheet_properties</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jsonSheet</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">],</span> <span class="s1">&#39;gridProperties/columnCount&#39;</span><span class="p">)</span>

    <span class="c1"># @TODO</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">updated</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Updated time in RFC 3339 format(use drive api)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="c1"># @TODO</span>
<div class="viewcode-block" id="Worksheet.link"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.link">[docs]</a>    <span class="k">def</span> <span class="nf">link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">syncToColoud</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Link the spread sheet with colud, so all local changes</span>
<span class="sd">            will be updated instantly, so does all data fetches</span>

<span class="sd">            :param  syncToColoud: update the cloud with local changes if set to true</span>
<span class="sd">                          update the local copy with cloud if set to false</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">syncToColoud</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">update_sheet_properties</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jsonSheet</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">wks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spreadsheet</span><span class="o">.</span><span class="n">worksheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">property</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">jsonSheet</span> <span class="o">=</span> <span class="n">wks</span><span class="o">.</span><span class="n">jsonSheet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_linked</span> <span class="o">=</span> <span class="bp">True</span></div>

    <span class="c1"># @TODO</span>
<div class="viewcode-block" id="Worksheet.unlink"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.unlink">[docs]</a>    <span class="k">def</span> <span class="nf">unlink</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Unlink the spread sheet with colud, so all local changes</span>
<span class="sd">            will be made on local copy fetched</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_linked</span> <span class="o">=</span> <span class="bp">False</span></div>

<div class="viewcode-block" id="Worksheet.get_id_fields"><a class="viewcode-back" href="../../pygsheets.html#pygsheets.models.Worksheet.get_id_fields">[docs]</a>    <span class="k">def</span> <span class="nf">get_id_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;spreadsheet_id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">spreadsheet</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="s1">&#39;worksheet_id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">}</span></div>

    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="Worksheet.get_addr"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.get_addr">[docs]</a>    <span class="k">def</span> <span class="nf">get_addr</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;flip&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        function to convert adress format of cells from one to another</span>

<span class="sd">        :param addr: adress as tuple or label</span>
<span class="sd">        :param output: -&#39;label&#39; will output label</span>
<span class="sd">                      - &#39;tuple&#39; will output tuple</span>
<span class="sd">                      - &#39;flip&#39; will convert to other type</span>
<span class="sd">        :returns: tuple or label</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_MAGIC_NUMBER</span> <span class="o">=</span> <span class="mi">64</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;label&#39;</span> <span class="ow">or</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;flip&#39;</span><span class="p">:</span>
                <span class="c1"># return self.get_addr_int(*addr)</span>
                <span class="n">row</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">addr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">col</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">addr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">col</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">IncorrectCellLabel</span><span class="p">(</span><span class="s1">&#39;(</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
                <span class="n">div</span> <span class="o">=</span> <span class="n">col</span>
                <span class="n">column_label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="k">while</span> <span class="n">div</span><span class="p">:</span>
                    <span class="p">(</span><span class="n">div</span><span class="p">,</span> <span class="n">mod</span><span class="p">)</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">div</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">mod</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">mod</span> <span class="o">=</span> <span class="mi">26</span>
                        <span class="n">div</span> <span class="o">-=</span> <span class="mi">1</span>
                    <span class="n">column_label</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">mod</span> <span class="o">+</span> <span class="n">_MAGIC_NUMBER</span><span class="p">)</span> <span class="o">+</span> <span class="n">column_label</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">column_label</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">label</span>

            <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;tuple&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">addr</span>

        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;tuple&#39;</span> <span class="ow">or</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;flip&#39;</span><span class="p">:</span>
                <span class="c1"># return self.get_int_addr(addr)</span>
                <span class="n">_cell_addr_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">r&#39;([A-Za-z]+)(\d+)&#39;</span><span class="p">)</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">_cell_addr_re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
                    <span class="n">column_label</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
                    <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">column_label</span><span class="p">)):</span>
                        <span class="n">col</span> <span class="o">+=</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">_MAGIC_NUMBER</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">26</span> <span class="o">**</span> <span class="n">i</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">IncorrectCellLabel</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span>
            <span class="k">elif</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">addr</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidArgumentValue</span></div>

    <span class="k">def</span> <span class="nf">_get_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_label</span><span class="p">,</span> <span class="n">end_label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;get range in A1 notation, given start and end labels</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">+</span> <span class="s1">&#39;!&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">start_label</span><span class="p">,</span> <span class="n">end_label</span><span class="p">))</span>

<div class="viewcode-block" id="Worksheet.cell"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.cell">[docs]</a>    <span class="k">def</span> <span class="nf">cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns  cell object at given address.</span>

<span class="sd">        :param addr: cell adress as either tuple (row, col) or cell label &#39;A1&#39;</span>

<span class="sd">        :returns: an instance of a :class:`Cell`</span>

<span class="sd">        Example:</span>

<span class="sd">        &gt;&gt;&gt; wks.cell((1,1))</span>
<span class="sd">        &lt;Cell R1C1 &quot;I&#39;m cell A1&quot;&gt;</span>

<span class="sd">        &gt;&gt;&gt; wks.cell(&#39;A1&#39;)</span>
<span class="sd">        &lt;Cell R1C1 &quot;I&#39;m cell A1&quot;&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_range</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">addr</span><span class="p">),</span> <span class="s1">&#39;ROWS&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">Worksheet</span><span class="o">.</span><span class="n">get_addr</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_range</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">label</span><span class="p">),</span> <span class="s1">&#39;ROWS&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CellNotFound</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;exceeds grid limits&#39;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">CellNotFound</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">e</span>

        <span class="k">return</span> <span class="n">Cell</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Worksheet.range"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.range">[docs]</a>    <span class="k">def</span> <span class="nf">range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alphanum</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a list of :class:`Cell` objects from specified range.</span>

<span class="sd">        :param alphanum: A string with range value in common format,</span>
<span class="sd">                         e.g. &#39;A1:A5&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">startcell</span> <span class="o">=</span> <span class="n">alphanum</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">endcell</span> <span class="o">=</span> <span class="n">alphanum</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">startcell</span><span class="p">,</span> <span class="n">endcell</span><span class="p">,</span> <span class="n">returnas</span><span class="o">=</span><span class="s1">&#39;cell&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Worksheet.values"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.values">[docs]</a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">returnas</span><span class="o">=</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span> <span class="n">majdim</span><span class="o">=</span><span class="s1">&#39;ROWS&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns value of cells given the topleft corner position</span>
<span class="sd">        and bottom right position</span>

<span class="sd">        :param start: topleft position as tuple or label</span>
<span class="sd">        :param end: bottomright position as tuple or label</span>
<span class="sd">        :param majdim: output as rowwise or columwise</span>
<span class="sd">                       takes - &#39;ROWS&#39; or &#39;COLMUNS&#39;</span>
<span class="sd">        :param returnas: return as list of strings of cell objects</span>
<span class="sd">                         takes - &#39;matrix&#39; or &#39;cell&#39;</span>

<span class="sd">        Example:</span>

<span class="sd">        &gt;&gt;&gt; wks.values((1,1),(3,3))</span>
<span class="sd">        [[u&#39;another look.&#39;, u&#39;&#39;, u&#39;est&#39;],</span>
<span class="sd">         [u&#39;EE 4212&#39;, u&quot;it&#39;s down there &quot;],</span>
<span class="sd">         [u&#39;ee 4210&#39;, u&#39;somewhere, let me take &#39;]]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start_label</span> <span class="o">=</span> <span class="n">Worksheet</span><span class="o">.</span><span class="n">get_addr</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span>
        <span class="n">end_label</span> <span class="o">=</span> <span class="n">Worksheet</span><span class="o">.</span><span class="n">get_addr</span><span class="p">(</span><span class="n">end</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span>
        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_range</span><span class="p">(</span><span class="n">start_label</span><span class="p">,</span> <span class="n">end_label</span><span class="p">),</span> <span class="n">majdim</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">returnas</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;matrix&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">values</span>
        <span class="k">elif</span> <span class="n">returnas</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;cell&#39;</span> <span class="ow">or</span> <span class="n">returnas</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;cells&#39;</span><span class="p">:</span>
            <span class="n">cells</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)):</span>
                <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">k</span><span class="p">])):</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Cell</span><span class="p">((</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">values</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="p">))</span>
                <span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cells</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span></div>

<div class="viewcode-block" id="Worksheet.all_values"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.all_values">[docs]</a>    <span class="k">def</span> <span class="nf">all_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">returnas</span><span class="o">=</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span> <span class="n">majdim</span><span class="o">=</span><span class="s1">&#39;ROWS&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a list of lists containing all cells&#39; values as strings.</span>

<span class="sd">        :param majdim: output as row wise or columwise</span>
<span class="sd">        :param returnas: return as list of strings of cell objects</span>

<span class="sd">        :type majdim: &#39;ROWS&#39;, &#39;COLUMNS&#39;</span>
<span class="sd">        :type returnas: &#39;matrix&#39;,&#39;cell&#39;</span>

<span class="sd">        Example:</span>

<span class="sd">        &gt;&gt;&gt; wks.all_values()</span>
<span class="sd">        [[u&#39;another look.&#39;, u&#39;&#39;, u&#39;est&#39;],</span>
<span class="sd">         [u&#39;EE 4212&#39;, u&quot;it&#39;s down there &quot;],</span>
<span class="sd">         [u&#39;ee 4210&#39;, u&#39;somewhere, let me take &#39;]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">),</span> <span class="n">returnas</span><span class="o">=</span><span class="n">returnas</span><span class="p">,</span> <span class="n">majdim</span><span class="o">=</span><span class="n">majdim</span><span class="p">)</span></div>

    <span class="c1"># @TODO improve empty2zero for other types also and clustring</span>
<div class="viewcode-block" id="Worksheet.get_all_records"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.get_all_records">[docs]</a>    <span class="k">def</span> <span class="nf">get_all_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">empty2zero</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">head</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of dictionaries, all of them having:</span>
<span class="sd">            - the contents of the spreadsheet&#39;s with the head row as keys, \</span>
<span class="sd">            And each of these dictionaries holding</span>
<span class="sd">            - the contents of subsequent rows of cells as values.</span>

<span class="sd">        Cell values are numericised (strings that can be read as ints</span>
<span class="sd">        or floats are converted).</span>

<span class="sd">        :param empty2zero: determines whether empty cells are converted to zeros.</span>
<span class="sd">        :param head: determines wich row to use as keys, starting from 1</span>
<span class="sd">            following the numeration of the spreadsheet.</span>

<span class="sd">        :returns: a dict dict with header column values as head and rows as list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">head</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_values</span><span class="p">()</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">numericise_all</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">empty2zero</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]]</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">row</span><span class="p">))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span></div>

<div class="viewcode-block" id="Worksheet.row"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.row">[docs]</a>    <span class="k">def</span> <span class="nf">row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">returnas</span><span class="o">=</span><span class="s1">&#39;matrix&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a list of all values in a `row`.</span>

<span class="sd">        Empty cells in this list will be rendered as :const:` `.</span>

<span class="sd">        :param row: - index of row</span>
<span class="sd">        :param returnas: - (&#39;matrix&#39; or &#39;cell&#39;) return as cell objects or just 2d array</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">((</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">),</span> <span class="n">returnas</span><span class="o">=</span><span class="n">returnas</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Worksheet.col"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.col">[docs]</a>    <span class="k">def</span> <span class="nf">col</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">returnas</span><span class="o">=</span><span class="s1">&#39;matrix&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a list of all values in column `col`.</span>

<span class="sd">        Empty cells in this list will be rendered as :const:` `.</span>

<span class="sd">        :param col: index of col</span>
<span class="sd">        :param returnas: (&#39;value&#39; or &#39;cell&#39;) return as cell objects or just values</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span> <span class="n">col</span><span class="p">),</span> <span class="n">majdim</span><span class="o">=</span><span class="s1">&#39;COLUMNS&#39;</span><span class="p">,</span> <span class="n">returnas</span><span class="o">=</span><span class="n">returnas</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Worksheet.update_cell"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.update_cell">[docs]</a>    <span class="k">def</span> <span class="nf">update_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">parse</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the new value to a cell.</span>

<span class="sd">        :param addr: cell adress as tuple (row,column) or label &#39;A1&#39;.</span>
<span class="sd">        :param val: New value</span>
<span class="sd">        :param parse: if the values should be stored \</span>
<span class="sd">                        as is or should be as if the user typed them into the UI</span>

<span class="sd">        Example:</span>

<span class="sd">        &gt;&gt;&gt; wks.update_cell(&#39;A1&#39;, &#39;42&#39;) # this could be &#39;a1&#39; as well</span>
<span class="sd">        &lt;Cell R1C1 &quot;42&quot;&gt;</span>
<span class="sd">        &gt;&gt;&gt; wks.update_cell(&#39;A3&#39;, &#39;=A1+A2&#39;, True)</span>
<span class="sd">        &lt;Cell R1C3 &quot;57&quot;&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">Worksheet</span><span class="o">.</span><span class="n">get_addr</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">update_range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_range</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">label</span><span class="p">),</span> <span class="p">[[</span><span class="n">val</span><span class="p">]],</span> <span class="n">parse</span><span class="p">)</span></div>

<div class="viewcode-block" id="Worksheet.update_cells"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.update_cells">[docs]</a>    <span class="k">def</span> <span class="nf">update_cells</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">majordim</span><span class="o">=</span><span class="s1">&#39;ROWS&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Updates cells in batch, it can take either a cell list or a range and values</span>

<span class="sd">        :param cell_list: List of a :class:`Cell` objects to update with their values</span>
<span class="sd">        :param range: range in format A1:A2</span>
<span class="sd">        :param values: list of values if range given</span>
<span class="sd">        :param majordim: major dimension of given data</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">cell_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">start_batch</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">cell_list</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_cell</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">stop_batch</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">range</span> <span class="ow">and</span> <span class="n">values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">update_range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_range</span><span class="p">(</span><span class="o">*</span><span class="nb">range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)),</span> <span class="n">values</span><span class="p">,</span> <span class="n">majordim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidArgumentValue</span><span class="p">(</span><span class="n">cell_list</span><span class="p">)</span>  <span class="c1"># @TODO test</span></div>

<div class="viewcode-block" id="Worksheet.update_col"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.update_col">[docs]</a>    <span class="k">def</span> <span class="nf">update_col</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;update an existing colum with values</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">colrange</span> <span class="o">=</span> <span class="n">Worksheet</span><span class="o">.</span><span class="n">get_addr</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="p">),</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">Worksheet</span><span class="o">.</span><span class="n">get_addr</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="n">index</span><span class="p">),</span> <span class="s2">&quot;label&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_cells</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="n">colrange</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="n">values</span><span class="p">],</span> <span class="n">majordim</span><span class="o">=</span><span class="s1">&#39;COLUMNS&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Worksheet.update_row"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.update_row">[docs]</a>    <span class="k">def</span> <span class="nf">update_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;update an existing row with values</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">colrange</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_addr</span><span class="p">((</span><span class="n">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_addr</span><span class="p">((</span><span class="n">index</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)),</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_cells</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="n">colrange</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="n">values</span><span class="p">],</span> <span class="n">majordim</span><span class="o">=</span><span class="s1">&#39;ROWS&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Worksheet.resize"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.resize">[docs]</a>    <span class="k">def</span> <span class="nf">resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Resizes the worksheet.</span>

<span class="sd">        :param rows: New rows number.</span>
<span class="sd">        :param cols: New columns number.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">=</span> <span class="n">rows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cols</span> <span class="o">=</span> <span class="n">cols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="Worksheet.add_rows"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.add_rows">[docs]</a>    <span class="k">def</span> <span class="nf">add_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds rows to worksheet.</span>

<span class="sd">        :param rows: Rows number to add.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">+</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">)</span></div>

<div class="viewcode-block" id="Worksheet.add_cols"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.add_cols">[docs]</a>    <span class="k">def</span> <span class="nf">add_cols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds colums to worksheet.</span>

<span class="sd">        :param cols: Columns number to add.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span> <span class="o">+</span> <span class="n">cols</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span></div>

    <span class="c1"># @TODO</span>
<div class="viewcode-block" id="Worksheet.delete_cols"><a class="viewcode-back" href="../../pygsheets.html#pygsheets.models.Worksheet.delete_cols">[docs]</a>    <span class="k">def</span> <span class="nf">delete_cols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Method not Implimented&quot;</span><span class="p">)</span></div>

    <span class="c1"># @TODO</span>
<div class="viewcode-block" id="Worksheet.delete_rows"><a class="viewcode-back" href="../../pygsheets.html#pygsheets.models.Worksheet.delete_rows">[docs]</a>    <span class="k">def</span> <span class="nf">delete_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Method not Implimented&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Worksheet.insert_cols"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.insert_cols">[docs]</a>    <span class="k">def</span> <span class="nf">insert_cols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Insert a colum after the colum &lt;col&gt; and fill with values &lt;values&gt;</span>

<span class="sd">        :param col: columer after which new colum should be inserted</span>
<span class="sd">        :param number: number of colums to be inserted</span>
<span class="sd">        :param values: values to filled in new colum</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">insertdim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s1">&#39;COLUMNS&#39;</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="p">(</span><span class="n">col</span><span class="o">+</span><span class="n">number</span><span class="p">),</span> <span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jsonSheet</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;gridProperties&#39;</span><span class="p">][</span><span class="s1">&#39;columnCount&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="o">+</span><span class="n">number</span>
        <span class="k">if</span> <span class="n">values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_col</span><span class="p">(</span><span class="n">col</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span></div>

<div class="viewcode-block" id="Worksheet.insert_rows"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.insert_rows">[docs]</a>    <span class="k">def</span> <span class="nf">insert_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Insert a row after the row &lt;row&gt; and fill with values &lt;values&gt;</span>

<span class="sd">        :param row: row after which new colum should be inserted</span>
<span class="sd">        :param number: number of rows to be inserted</span>
<span class="sd">        :param values: values to be filled in new row</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">insertdim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s1">&#39;ROWS&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="p">(</span><span class="n">row</span><span class="o">+</span><span class="n">number</span><span class="p">),</span> <span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jsonSheet</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;gridProperties&#39;</span><span class="p">][</span><span class="s1">&#39;rowCount&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">+</span> <span class="n">number</span>
        <span class="k">if</span> <span class="n">values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_row</span><span class="p">(</span><span class="n">row</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span></div>

    <span class="c1"># @TODO</span>
<div class="viewcode-block" id="Worksheet.append_row"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.append_row">[docs]</a>    <span class="k">def</span> <span class="nf">append_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a row to the worksheet and populates it with values.</span>
<span class="sd">        Widens the worksheet if there are more values than columns.</span>

<span class="sd">        :param values: List of values for the new row.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Method not Implimented&quot;</span><span class="p">)</span></div>

    <span class="c1"># @TODO</span>
    <span class="k">def</span> <span class="nf">_finder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Method not Implimented&quot;</span><span class="p">)</span>

    <span class="c1"># @TODO</span>
<div class="viewcode-block" id="Worksheet.find"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.find">[docs]</a>    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds first cell matching query.</span>

<span class="sd">        :param query: A text string or compiled regular expression.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

    <span class="c1"># @TODO</span>
<div class="viewcode-block" id="Worksheet.findall"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.findall">[docs]</a>    <span class="k">def</span> <span class="nf">findall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds all cells matching query.</span>

<span class="sd">        :param query: A text string or compiled regular expression.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Method not Implimented&quot;</span><span class="p">)</span></div>

    <span class="c1"># @TODO</span>
<div class="viewcode-block" id="Worksheet.export"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Worksheet.export">[docs]</a>    <span class="k">def</span> <span class="nf">export</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;csv&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Export the worksheet in specified format.</span>

<span class="sd">        :param format: A format of the output.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Method not Implimented&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Cell"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Cell">[docs]</a><span class="k">class</span> <span class="nc">Cell</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;An instance of this class represents a single cell</span>
<span class="sd">    in a :class:`worksheet &lt;Worksheet&gt;`.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">worksheet</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worksheet</span> <span class="o">=</span> <span class="n">worksheet</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">Worksheet</span><span class="o">.</span><span class="n">get_addr</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="s1">&#39;tuple&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_row</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_label</span> <span class="o">=</span> <span class="n">Worksheet</span><span class="o">.</span><span class="n">get_addr</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">val</span>  <span class="c1"># formated vlaue</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unformated_value</span> <span class="o">=</span> <span class="n">val</span>    <span class="c1"># @TODO</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_formula</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c1"># @TODO use the render_as</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="n">FormatType</span><span class="o">.</span><span class="n">CUSTOM</span>  <span class="c1"># @TODO</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">render_as</span> <span class="o">=</span> <span class="n">ValueRenderOption</span><span class="o">.</span><span class="n">FORMATTED</span>  <span class="c1"># @TODO use this</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parse_value</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c1"># @TODO</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">row</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Row number of the cell.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row</span>

    <span class="nd">@row.setter</span>
    <span class="k">def</span> <span class="nf">row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">worksheet</span><span class="p">:</span>
            <span class="n">ncell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">worksheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ncell</span><span class="o">.</span><span class="n">__dict__</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_row</span> <span class="o">=</span> <span class="n">row</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">col</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Column number of the cell.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col</span>
    
    <span class="nd">@col.setter</span>
    <span class="k">def</span> <span class="nf">col</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">worksheet</span><span class="p">:</span>
            <span class="n">ncell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">worksheet</span><span class="o">.</span><span class="n">cell</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ncell</span><span class="o">.</span><span class="n">__dict__</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_col</span> <span class="o">=</span> <span class="n">col</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">label</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Cell Label - Eg A1&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_label</span>

    <span class="nd">@label.setter</span>
    <span class="k">def</span> <span class="nf">label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">worksheet</span><span class="p">:</span>
            <span class="n">ncell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">worksheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ncell</span><span class="o">.</span><span class="n">__dict__</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_label</span> <span class="o">=</span> <span class="n">label</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;formated value of the cell&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>

    <span class="nd">@value.setter</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">worksheet</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">worksheet</span><span class="o">.</span><span class="n">update_cell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">formula</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;formula if any of the cell&quot;&quot;&quot;</span>
        <span class="c1"># fetch formula</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formula</span>

    <span class="nd">@formula.setter</span>
    <span class="k">def</span> <span class="nf">formula</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formula</span><span class="p">):</span>
        <span class="n">tmp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_value</span><span class="p">,</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">formula</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parse_value</span> <span class="o">=</span> <span class="bp">True</span>

<div class="viewcode-block" id="Cell.fetch"><a class="viewcode-back" href="../../reference.html#pygsheets.models.Cell.fetch">[docs]</a>    <span class="k">def</span> <span class="nf">fetch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Update the value of the cell from sheet &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">worksheet</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">worksheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_label</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;</span><span class="si">%s</span><span class="s1"> R</span><span class="si">%s</span><span class="s1">C</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">row</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">col</span><span class="p">,</span>
                                   <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">))</span></div>

</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, nithinmurali.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>